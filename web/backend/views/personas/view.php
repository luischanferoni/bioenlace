<?php

use yii\helpers\Html;
use yii\widgets\DetailView;
use yii\helpers\ArrayHelper;
use yii\helpers\Url;
use yii\bootstrap5\Modal;

use common\models\User;
use common\components\SisseGhostHtml;

use common\models\persona_telefono;
use common\models\Tipo_telefono;
use common\models\Localidad;

/* @var $this yii\web\View */
/* @var $model common\models\persona */

//$this->title = $model->id_persona; 
//$this->title = "Datos Personales de: " . $model->apellido . " " . $model->otro_apellido . ", " . $model->nombre . " " . $model->otro_nombre;
$this->title = 'Persona';

$this->params['breadcrumbs'][] = ['label' => 'Personas', 'url' => ['buscar-persona']];
$this->params['breadcrumbs'][] = $this->title;
?>


<div class="row">
    <div class="col-sm-12">
        <div class="card-group mb-3">
            <div class="card">
                <div class="card-header bg-soft-primary d-flex justify-content-center align-items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="125" height="125" fill="currentColor" class="bi bi-calendar2-plus" viewBox="0 0 16 16">
                        <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM2 2a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1H2z" />
                        <path d="M2.5 4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5H3a.5.5 0 0 1-.5-.5V4zM8 8a.5.5 0 0 1 .5.5V10H10a.5.5 0 0 1 0 1H8.5v1.5a.5.5 0 0 1-1 0V11H6a.5.5 0 0 1 0-1h1.5V8.5A.5.5 0 0 1 8 8z" />
                    </svg>
                </div>
                <div class="card-body">
                    <h4 class="mb-2">Turnos</h4>
                    <div class="row"> <?= Html::a('Asignar Turno', ['/turnos/index'], ['class' => 'ms-2']); ?></div>
                    <div class="row"> <?= Html::a('Ver Turnos', ['/turnos/view', 'id_persona' => $model->id_persona], ['class' => 'ms-2']) ?></div>
                </div>
            </div>

            <div class="card">
                <div class="card-header bg-soft-primary d-flex justify-content-center align-items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision" text-rendering="geometricPrecision" image-rendering="optimizeQuality" fill-rule="evenodd" clip-rule="evenodd" viewBox="0 0 512 444.97" width="125" height="125" fill="currentColor">
                        <path d="m235.51 272.75 58.39 40.17 58.38-40.17H235.51zM52.37 0C76.46 0 96 19.53 96 43.63S76.46 87.26 52.37 87.26c-24.1 0-43.63-19.53-43.63-43.63S28.27 0 52.37 0zm68.08 150.67c-22.5-10.3-10.79-48.78 16.95-29.41l55.51 38.79 85.75 1.73c9.18.07 16.56 7.57 16.49 16.75-.07 9.18-7.57 16.56-16.75 16.49l-86.51-1.74c-1.67.13-3.39 0-5.11-.41l-66.33-42.2zm338.7 36.7c30.23 3.83 42-45.64 6.08-52.64l-230.46-6.75c-29.08-2.89-58.7-64.08-113.79-61.52-33.9 1.58-46.21 34.57-20.08 65.67.04-4.33 1.07-8.57 2.97-12.19l.26-.46c2.05-3.69 5.02-6.78 8.81-8.81 7.37-3.94 17.38-3.75 28.87 4.28l53.59 37.44 83.48 1.69a24.24 24.24 0 0 1 16.99 7.25 24.276 24.276 0 0 1 6.98 17.26c-.03 3.89-.97 7.56-2.62 10.81l25.71-1.39 133.21-.64zM1.08 134.93l127.49 103.23c2.29 2.3 2.91 2.36 6.12 2.36h374.48c1.56 0 2.83-1.27 2.83-2.82v-26.13c0-1.55-1.33-2.83-2.83-2.83H151.19c-.34 0-.7.07-1.03.19L29.35 106.66c-1.48-1.26-3.65-1.37-5.02 0L1.08 129.91c-1.37 1.37-1.51 3.8 0 5.02zm391.96 244.71c18.04 0 32.66 14.63 32.66 32.67s-14.62 32.66-32.66 32.66-32.67-14.62-32.67-32.66c0-9.59 4.13-18.23 10.72-24.2l-77.2-53.18-71.86 49.51c9.37 5.74 15.62 16.07 15.62 27.87 0 18.04-14.62 32.66-32.66 32.66s-32.67-14.62-32.67-32.66c0-14.34 9.24-26.52 22.09-30.91l.3-.23 83.21-57.25-74.25-51.17h-87.73c-1.96 0-3.61-1.62-3.61-3.6v-10.99c0-1.99 1.63-3.61 3.61-3.61h385.74c1.98 0 3.61 1.65 3.61 3.61v10.99c0 1.96-1.65 3.6-3.61 3.6H384.12l-74.25 51.17 81.09 55.79c.69-.04 1.38-.07 2.08-.07zm0 21.12c6.37 0 11.54 5.17 11.54 11.55 0 6.37-5.17 11.54-11.54 11.54-6.38 0-11.55-5.17-11.55-11.54 0-6.38 5.17-11.55 11.55-11.55zm-188.05 0c6.37 0 11.54 5.17 11.54 11.55 0 6.37-5.17 11.54-11.54 11.54-6.38 0-11.55-5.17-11.55-11.54 0-6.38 5.17-11.55 11.55-11.55z" />
                    </svg>
                </div>
                <div class="card-body">
                    <h4 class="mb-2">Internación</h4>
                    <div class="row"><?= Html::a('Asignar Cama', ['/internacion'], ['class' => 'ms-2']); ?></div>
                    <?php
                    if ($model->internaciones) {
                        echo '<div class="row">' . Html::a(
                            'Listado Internaciones',
                            ['/internacion/porpersona', 'idpersona' => $model->id_persona],
                            $options = [
                                'title' => 'Listado de Internaciones registradas',
                                'class' => 'ms-2'
                            ]
                        ) . '</div>';
                    }
                    ?>
                </div>
            </div>

            <div class="card">
                <div class="card-header bg-soft-primary d-flex justify-content-center align-items-center">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 122.22 122.88" style="enable-background:new 0 0 122.22 122.88" xml:space="preserve" width="125" height="125" fill="currentColor">
                        <g>
                            <path d="M50.19,45.72l13.25,13.25c1.1,1.1,1.1,2.9,0,4c-1.1,1.1-2.9,1.1-4,0L46.19,49.72l-5.46,5.46l13.25,13.25 c1.1,1.1,1.1,2.9,0,4c-1.1,1.1-2.9,1.1-4,0L36.73,59.19l-5.46,5.46L44.52,77.9c1.1,1.1,1.1,2.9,0,4c-1.1,1.1-2.9,1.1-4,0 L27.27,68.65l-5.46,5.46l13.25,13.25c1.1,1.1,1.1,2.9,0,4c-1.1,1.1-2.9,1.1-4,0L17.81,78.11l-0.93,0.93h0 c-2.49,2.49-3.73,5.77-3.73,9.05c0,3.28,1.24,6.57,3.73,9.05l0,0l3.71,3.71c0.31,0.14,0.6,0.33,0.86,0.59 c0.25,0.26,0.45,0.55,0.59,0.86l4.4,4.4l0,0c2.17,2.17,5.03,3.25,7.9,3.25s5.73-1.09,7.9-3.25l0,0l42.24-42.24l-26.5-26.5 L50.19,45.72L50.19,45.72z M60.31,32.11l2.72,2.72l15.19-15.19c-1.93-2.22-2.9-5-2.9-7.78c0-3.04,1.16-6.08,3.47-8.39l0,0l0,0 C81.1,1.16,84.15,0,87.19,0c3.04,0,6.08,1.16,8.39,3.47l23.18,23.18c2.3,2.3,3.45,5.35,3.45,8.39h0.01c0,3.04-1.16,6.08-3.47,8.39 l0,0c-2.31,2.31-5.35,3.47-8.39,3.47c-2.61,0-5.21-0.85-7.36-2.55L87.78,59.58l2.53,2.53c0.2,0.2,0.36,0.43,0.48,0.67l5.66,5.66 c1.1,1.1,1.1,2.9,0,4c-1.1,1.1-2.9,1.1-4,0l-4.48-4.48l-42.24,42.24l0,0c-3.14,3.14-7.27,4.71-11.4,4.71 c-4.13,0-8.26-1.57-11.4-4.71l0,0l-3.12-3.12L4.83,122.05c-1.1,1.1-2.9,1.1-4,0c-1.1-1.1-1.1-2.9,0-4l14.98-14.98l-2.43-2.43v0 c-3.45-3.45-5.18-8-5.18-12.55c0-4.55,1.73-9.1,5.18-12.55v0l41.08-41.08l-4.02-4.02c-1.1-1.1-1.1-2.9,0-4c1.1-1.1,2.9-1.1,4,0 l5.2,5.2C59.88,31.75,60.11,31.91,60.31,32.11L60.31,32.11z M114.26,31.15L91.08,7.97c-1.07-1.07-2.48-1.6-3.89-1.6 c-1.41,0-2.82,0.53-3.89,1.6l0,0l0,0c-1.07,1.07-1.6,2.48-1.6,3.89c0,1.41,0.53,2.82,1.6,3.89h0l23.18,23.18 c1.07,1.07,2.48,1.6,3.89,1.6c1.41,0,2.82-0.53,3.89-1.6l0,0c1.07-1.07,1.6-2.48,1.6-3.89h0.01 C115.87,33.63,115.33,32.22,114.26,31.15L114.26,31.15z M98.29,40.06L82.55,24.32L68.12,38.75l15.74,15.74L98.29,40.06L98.29,40.06 z" />
                        </g>
                    </svg>
                </div>
                <div class="card-body">
                    <h4 class="mb-2">Enfermería</h4>
                    <div class="row"><?= Html::a(
                                            'Atención Enfermería',
                                            ['atenciones-enfermeria/create', 'id_persona' => $model->id_persona],
                                            $options = [
                                                'class' => 'linkaModalGeneral ms-2',
                                                'id' => 'linkaModalGeneral_' . $model->id_persona,
                                                'title' => 'Valores de Atenciones/Controles',
                                                'data-title' => "Atencion de Enfermeria"
                                            ]
                                        ); ?></div>

                    <div class="row"><?= Html::a(
                                            'Ver Atenciones de Enfermería',
                                            ['atenciones-enfermeria/view', 'id' => $model->id_persona],
                                            ['class' => 'ms-2'],
                                            ['title' => 'Valores de Atenciones/Controles']
                                        ); ?></div>
                </div>
            </div>

            <div class="card">
                <div class="card-header bg-soft-primary d-flex justify-content-center align-items-center">
                    <svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 98.82 122.88" width="125" height="125" fill="currentColor">
                        <defs>
                            <style>
                                .cls-1 {
                                    fill-rule: evenodd;
                                }
                            </style>
                        </defs>
                        <title>medical-history</title>
                        <path class="cls-1" d="M6.57,13.17H22.34V19H11.18a5.62,5.62,0,0,0-5.56,5.55v87a5.6,5.6,0,0,0,5.56,5.55H87.64a5.57,5.57,0,0,0,5.55-5.55v-87A5.6,5.6,0,0,0,87.64,19H76.48V13.17H92.24a6.6,6.6,0,0,1,6.58,6.57v96.57a6.62,6.62,0,0,1-6.58,6.57H6.57A6.6,6.6,0,0,1,0,116.31V19.74a6.59,6.59,0,0,1,6.57-6.57Zm44,19.44H85.24V35.9H50.52V32.61Zm0,17.92H62.47v3.3H50.52v-3.3Zm0-9.33H67.31v3.3H50.52V41.2Zm25.13-.92h2.87a1,1,0,0,1,1,1v3.33h3.33a1,1,0,0,1,1,1v2.88a1,1,0,0,1-1,1H79.5v3.25a1,1,0,0,1-1,1H75.65a1,1,0,0,1-1-1V49.42H71.34a1,1,0,0,1-1-1V45.57a1,1,0,0,1,1-1h3.33V41.26a1,1,0,0,1,1-1Zm-52,6.33c.14-.31.26-.66.34-.89a11.45,11.45,0,0,1-.9-1.29L22.2,43a2.66,2.66,0,0,1-.51-1.32.94.94,0,0,1,.09-.48.83.83,0,0,1,.31-.36.94.94,0,0,1,.22-.12,22.59,22.59,0,0,1,0-2.61,3.84,3.84,0,0,1,.11-.59,3.52,3.52,0,0,1,1.54-2,4.74,4.74,0,0,1,1.3-.58c.29-.08-.25-1,.05-1,1.45-.15,3.8,1.18,4.81,2.27a3.55,3.55,0,0,1,.9,2.24l-.06,2.38h0a.63.63,0,0,1,.48.49,2,2,0,0,1-.25,1.25h0l0,0-1,1.72A9.09,9.09,0,0,1,28.82,46a2.43,2.43,0,0,0,.14.2c1.76,2.59,4.14,1.26,6.91,3.28l-.09.11V54H17V49.55H17a.25.25,0,0,1,.12-.13c1.79-1,5.92-1.39,6.55-2.81Zm-9-17.55H38.11a2,2,0,0,1,2,2V56.86a2,2,0,0,1-.59,1.39,2,2,0,0,1-1.4.6H14.72a2,2,0,0,1-2-2V31.05a2,2,0,0,1,2-2Zm23.39,1.7H14.72a.29.29,0,0,0-.2.09.25.25,0,0,0-.09.2V56.86a.28.28,0,0,0,.09.19.27.27,0,0,0,.2.09H38.11a.31.31,0,0,0,.28-.28V31.05a.27.27,0,0,0-.09-.2.28.28,0,0,0-.19-.09ZM13.78,101.68H69.91V105H13.78v-3.27Zm0-12.55H85V92.4H13.78V89.13Zm0-14.86h17l3.07-6.22,6.05,8.71L46,64.84l6.31,12.37L55,74.7l1.1-.43h8.63l5.41-5.58,5,5.58H85v3.27H73.69l-3.63-4.07-3.94,4.07H56.74l-5.42,5L46,72,40.27,83.07l-6-8.63-1.53,3.1h-19V74.27ZM31.45,9.18H38.9A10.18,10.18,0,0,1,48.78,0a10.16,10.16,0,0,1,9.86,9.07l8.72.11a1.1,1.1,0,0,1,1.1,1.1V20.79a1.1,1.1,0,0,1-1.1,1.1H31.46a1.1,1.1,0,0,1-1.1-1.1V10.28a1.08,1.08,0,0,1,1.09-1.1Zm13.24,4.51A7.43,7.43,0,0,0,47.35,16,4.78,4.78,0,0,0,50,16a7.17,7.17,0,0,0,3.1-3.3,5.44,5.44,0,0,0,.11-1.09,4.45,4.45,0,1,0-8.88,0,5.16,5.16,0,0,0,.41,2Z" />
                    </svg>

                </div>

                <div class="card-body">
                    <h4 class="mb-2">Historia Clínica</h4>

                    <?php

                    if ($num_hc != "--") {
                        echo '<div class="row">' .  Html::a(
                            'Nro.' . $num_hc,
                            ['personas/crear-numero-historia-clinica', 'id' => $model->id_persona],
                            $options = [
                                'class' => 'linkaModalGeneral num-hc ms-2',
                                'data-title' => "Actualización Numero de Historia Clinica",
                                'title' => 'Actualizar Numero de Historia Clinica',
                            ]
                        ) . '</div>';
                    } else {
                        echo '<div class="row">' . Html::a(
                            'Nuevo Nro de HC (Papel)',
                            ['personas/crear-numero-historia-clinica', 'id' => $model->id_persona],
                            $options = [
                                'class' => 'linkaModalGeneral ms-2',
                                'data-title' => "Nuevo numero de historia clinica",
                                'title' => 'Crear numero de historia clinica',
                            ]
                        ) . '</div>';
                    }

                    ?>


                    <?php
                    echo '<div class="row">' . Html::a(
                        'Historia Clinica',
                        ['consultas/historialconsultas', 'id' => $model->id_persona . (isset($mpi_id) && $mpi_id != '' ? '&mpi_id=' . $mpi_id : '')],
                        $options = [
                            'class' => 'linkaModalGeneral ms-2',
                            'data-title' => "Historial de Consultas",
                            'title' => 'Ir a listado historial de consultas',
                        ]
                    ) . '</div>';
                    ?>

                    <?= '<div class="row">' . Html::a(
                        'HC Externa',
                        ['consultas/ips-historia-clinica', 'id' => $model->id_persona],
                        $options = [
                            'class' => 'linkaModalGeneral ms-2',
                            'data-title' => "Historia Clinica IPS",
                            'title' => 'Ir a historia clinica IPS',
                        ]
                    ) . '</div>'; ?>

                    <?= '<div class="row">' . Html::a(
                        'Antecedentes',
                        ['consultas/historialantecedentes', 'id' => $model->id_persona],
                        $options = [
                            'class' => 'linkaModalGeneral ms-2',
                            'data-title' => "Historial de Antecedentes",
                            'title' => 'Ir a listado historial de antecedentes',
                        ]
                    ) . '</div>'; ?>
                </div>
            </div>
        </div>
    </div>

</div>

<div class="row">
    <div class="col-sm-12">
        <div class="card-group mb-3">
            <div class="card">
                <div class="card-header bg-soft-primary d-flex justify-content-center align-items-center">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 122.88 117.34" style="enable-background:new 0 0 122.88 117.34" xml:space="preserve" width="125" height="125" fill="currentColor">
                        <style type="text/css">
                            .st0 {
                                fill-rule: evenodd;
                                clip-rule: evenodd;
                            }
                        </style>
                        <g>
                            <path class="st0" d="M54.36,38.66c4.7,0,8.51,3.81,8.51,8.51c0,4.7-3.81,8.51-8.51,8.51c-4.7,0-8.51-3.81-8.51-8.51 C45.84,42.47,49.66,38.66,54.36,38.66L54.36,38.66z M48.17,7.08c-1.5-3.34-5.42-4.83-8.76-3.34c-3.34,1.5-4.83,5.42-3.34,8.76 c0.99,2.2,3.03,3.6,5.26,3.87l3.93,7.75c-3.68,1.8-7.02,4.19-9.89,7.06c-0.22,0.22-0.43,0.43-0.64,0.65l-9.43-5.02 c0.12-1.25-0.02-2.55-0.46-3.81c-1.63-4.7-6.77-7.18-11.47-5.55c-4.7,1.63-7.18,6.77-5.55,11.47c1.63,4.7,6.77,7.18,11.47,5.55 c0.99-0.34,1.88-0.84,2.66-1.46l8.38,4.46c-2.7,4.25-4.56,9.1-5.32,14.3l-6.86,0.1c-1.15-1.7-3.08-2.85-5.29-2.91 c-3.66-0.11-6.71,2.77-6.82,6.43c-0.11,3.66,2.77,6.71,6.43,6.82c2.52,0.07,4.75-1.26,5.93-3.3l6.26-0.09 c0.13,2.94,0.61,5.78,1.39,8.5l-17,9.2c-1.06-0.42-2.24-0.56-3.44-0.38c-3.62,0.57-6.09,3.96-5.52,7.58 c0.57,3.62,3.96,6.09,7.58,5.52c3.41-0.54,5.81-3.59,5.59-6.97l15.42-8.34c1.75,3.41,4.03,6.51,6.71,9.2 c0.2,0.2,0.41,0.41,0.62,0.61l-7.65,10.82c-1.38-0.31-2.85-0.3-4.31,0.09c-4.81,1.29-7.66,6.23-6.37,11.03 c1.29,4.81,6.23,7.66,11.03,6.37c4.81-1.29,7.66-6.23,6.37-11.03c-0.23-0.85-0.57-1.64-1.01-2.36l7.47-10.56 c4.33,2.78,9.29,4.68,14.62,5.43l-1.27,10.25c-3.49,1.73-4.96,5.94-3.29,9.48c1.69,3.57,5.96,5.1,9.53,3.4 c3.57-1.69,5.1-5.96,3.4-9.53c-0.59-1.25-1.49-2.24-2.57-2.94l1.28-10.34c6.02-0.3,11.66-2.06,16.58-4.92l2.88,4.08l4,5.66 c-0.44,0.72-0.78,1.51-1.01,2.36c-1.29,4.81,1.56,9.75,6.37,11.03c4.81,1.29,9.75-1.56,11.03-6.37c1.29-4.81-1.56-9.75-6.37-11.03 c-1.46-0.39-2.93-0.4-4.31-0.09l-3.98-5.62l-2.92-4.12c0.62-0.54,1.22-1.1,1.8-1.68c2.44-2.43,4.53-5.21,6.21-8.25l16.28,5.76 c0.7,2.91,3.32,5.07,6.44,5.07c3.66,0,6.63-2.97,6.63-6.63c0-3.66-2.97-6.63-6.63-6.63c-1.59,0-3.05,0.56-4.19,1.49l-15.73-5.57 c1.13-3.54,1.75-7.31,1.75-11.23c0-3.54-0.5-6.97-1.44-10.21l8.75-4.27c1.01,0.79,2.25,1.33,3.62,1.48 c3.93,0.44,7.47-2.39,7.91-6.32c0.44-3.93-2.39-7.47-6.32-7.91c-3.89-0.43-7.39,2.33-7.89,6.19l-8.69,4.24 c-1.48-2.88-3.34-5.54-5.5-7.92l12.13-12.7c0.93,0.35,1.94,0.54,2.99,0.56c4.98,0.08,9.07-3.89,9.15-8.87 c0.08-4.97-3.89-9.07-8.87-9.15s-9.07,3.89-9.15,8.87c-0.02,1.33,0.25,2.6,0.75,3.74L83.3,27.7c-3.56-2.66-7.63-4.69-12.02-5.92 l1.07-9.01c2.27-0.92,3.94-3.07,4.12-5.68c0.26-3.65-2.5-6.82-6.15-7.08c-3.65-0.26-6.82,2.5-7.08,6.15 c-0.15,2.1,0.7,4.04,2.14,5.35l-1.07,9.02c-0.98-0.08-1.96-0.12-2.96-0.12c-3.26,0-6.42,0.43-9.43,1.22l-4.21-8.29 C48.87,11.53,49.12,9.19,48.17,7.08L48.17,7.08z M82.05,36.45c-5.3-5.3-12.62-8.57-20.7-8.57c-8.08,0-15.4,3.28-20.7,8.57 c-5.3,5.3-8.57,12.62-8.57,20.7c0,8.08,3.28,15.4,8.57,20.7c5.3,5.3,12.62,8.57,20.7,8.57c8.08,0,15.4-3.28,20.7-8.57 c5.3-5.3,8.57-12.62,8.57-20.7C90.63,49.07,87.35,41.75,82.05,36.45L82.05,36.45z M76.33,48.21c2.7,0,4.88,2.19,4.88,4.88 c0,2.7-2.19,4.88-4.88,4.88c-2.7,0-4.88-2.19-4.88-4.88C71.45,50.39,73.63,48.21,76.33,48.21L76.33,48.21z M61.24,61.96 c4.7,0,8.51,3.81,8.51,8.51c0,4.7-3.81,8.51-8.51,8.51c-4.7,0-8.51-3.81-8.51-8.51C52.72,65.78,56.53,61.96,61.24,61.96 L61.24,61.96z" />
                        </g>
                    </svg>
                </div>
                <div class="card-body">
                    <h4 class="mb-2">Covid-19</h4>
                    <?= '<div class="row">' . Html::a(
                        'Entrevista Post Covid-19',
                        ['covid-entrevista-telefonica/create', 'id_persona' => $model->id_persona],
                        ['class' => 'ms-2'],
                        $options = ['title' => 'Cargar Entrevista Telefónica Post Covid-19']
                    ) . '</div>'; ?>

                    <?= '<div class="row">' . Html::a(
                        'Listado Entrevistas',
                        ['covid-entrevista-telefonica/listado', 'id_persona' => $model->id_persona],
                        ['class' => 'ms-2'],
                        $options = ['title' => 'Listado de Entrevistas Telefónicas Post Covid-19']
                    ) . '</div>'; ?>
                </div>

            </div>

            <div class="card">
                <div class="card-header bg-soft-primary d-flex justify-content-center align-items-center">
                    <svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 122.88 76.77" width="125" height="125" fill="currentColor">
                        <title>care</title>
                        <path d="M69.93,14a7,7,0,0,1,2,.28,6.6,6.6,0,0,1,1.29.53V13.63A6.68,6.68,0,0,1,73.7,11a6.93,6.93,0,0,1,1.49-2.23A6.77,6.77,0,0,1,77.42,7.3,6.69,6.69,0,0,1,80,6.77h0a6.76,6.76,0,0,1,2,.32,6.86,6.86,0,0,1,1.36.6V6.85A6.92,6.92,0,0,1,84,4.23,7,7,0,0,1,85.46,2h0A6.74,6.74,0,0,1,87.68.52,6.83,6.83,0,0,1,90.29,0a6.85,6.85,0,0,1,4.84,2,7,7,0,0,1,1.49,2.23,6.73,6.73,0,0,1,.52,2.62v.86a7.11,7.11,0,0,1,1.33-.57,6.71,6.71,0,0,1,4.63.22,6.86,6.86,0,0,1,4.24,6.33V44.13q.06.4.09.81a7.87,7.87,0,0,1,0,.84v1.09c.72-.68,1.39-1.35,1.84-1.8l.41-.4A10.28,10.28,0,0,1,113.86,42a7,7,0,0,1,4.35-.05,6.18,6.18,0,0,1,1.56.73,6.07,6.07,0,0,1,1.31,1.11,6.65,6.65,0,0,1,1,1.43,6.83,6.83,0,0,1,.6,1.62,8,8,0,0,1-.4,4.81,11.83,11.83,0,0,1-3.19,4.4l-.07.07c-.75.75-1.75,1.83-2.93,3.09-4.93,5.29-12.89,13.81-18,15.86-4.14,1.65-10.48,2.1-16.41,1.29-5.3-.72-10.3-2.45-13.15-5.25l2.55-2.53c2.32,2.25,6.64,3.65,11.26,4.24,5.3.67,11,.28,14.41-1.09,4.53-1.8,12.92-10.86,17.4-15.67,1-1.09,1.81-1.95,2.34-2.49l.17-.17.05,0a8.23,8.23,0,0,0,2.14-2.83,4.5,4.5,0,0,0,.33-2.85,3.9,3.9,0,0,0-.29-.79,3.53,3.53,0,0,0-.46-.68h0a3,3,0,0,0-.58-.49,2.83,2.83,0,0,0-.7-.34h0a3.66,3.66,0,0,0-2.34.11,7.21,7.21,0,0,0-2.5,1.7c-.42.43-1.57,1.57-2.71,2.64-.57.54-1.15,1.07-1.69,1.5a9.79,9.79,0,0,1-1.22.89,1.56,1.56,0,0,1-.47.22,1.75,1.75,0,0,1-.51.08.31.31,0,0,1-.17-.05l-1.15-.56a.32.32,0,0,1-.18-.27l-.35-5.87c0-5.78,0-10.91,0-16,0-5.45,0-10.92,0-16.06a3.19,3.19,0,0,0-.24-1.24,3.42,3.42,0,0,0-.71-1.05,3.3,3.3,0,0,0-1-.71,3.38,3.38,0,0,0-1.24-.24,3.32,3.32,0,0,0-2.29.95,3.27,3.27,0,0,0-1,2.29V39.3a.32.32,0,0,1-.32.32H93.85a.32.32,0,0,1-.32-.32V6.86a3.19,3.19,0,0,0-.25-1.24,3,3,0,0,0-.7-1,3.19,3.19,0,0,0-1.06-.71,3.1,3.1,0,0,0-1.23-.24,3.19,3.19,0,0,0-1.24.24,3.42,3.42,0,0,0-1,.71,3.3,3.3,0,0,0-.71,1,3.19,3.19,0,0,0-.24,1.24V39.3a.32.32,0,0,1-.32.32H86A15.9,15.9,0,0,0,84,36.22c-.24-.33-.5-.65-.77-1V13.63A3.38,3.38,0,0,0,83,12.39a3.42,3.42,0,0,0-.71-1.05A3.27,3.27,0,0,0,80,10.39a3.27,3.27,0,0,0-1.24.25,3.25,3.25,0,0,0-2,3v17a16.49,16.49,0,0,0-3.61-1V20.86a3.14,3.14,0,0,0-.25-1.23,3.32,3.32,0,0,0-.7-1.06,3.26,3.26,0,0,0-1.06-.7,3.14,3.14,0,0,0-1.23-.25,3.19,3.19,0,0,0-1.24.25,3,3,0,0,0-1,.7,3.19,3.19,0,0,0-.71,1.06,3.14,3.14,0,0,0-.24,1.23v9.07a13.94,13.94,0,0,0-3.61,1.41V20.86a6.87,6.87,0,0,1,4.24-6.33A6.77,6.77,0,0,1,69.93,14ZM61.24,41c2.57-2.68,4.37-5,8.32-5.44,7.42-.85,14.25,6.74,10.5,14.22a33.05,33.05,0,0,1-5.64,7.15c-2.64,2.73-5.55,5.41-7.6,7.44l-5.57,5.53-4.61-4.44C51.1,60.1,42.06,53.38,41.76,45.06c-.2-5.83,4.4-9.57,9.69-9.5,4.73.06,6.72,2.41,9.79,5.41ZM51,14.29A7,7,0,0,1,53,14a6.77,6.77,0,0,1,2.62.52,6.86,6.86,0,0,1,4.24,6.33v10.9a13.43,13.43,0,0,0-3.62-1.6v-9.3a3.14,3.14,0,0,0-.24-1.23,3.19,3.19,0,0,0-.71-1.06,3,3,0,0,0-1-.7,3.24,3.24,0,0,0-3.51.69h0a3.27,3.27,0,0,0-1,2.29v8.77a16.8,16.8,0,0,0-3.61.76V13.63a3.24,3.24,0,0,0-5.53-2.29,3.42,3.42,0,0,0-.71,1.05,3.38,3.38,0,0,0-.24,1.24V34.54a14.48,14.48,0,0,0-3,5.08h-.45a.32.32,0,0,1-.32-.32V6.86a3.19,3.19,0,0,0-.24-1.24,3.3,3.3,0,0,0-.71-1,3.42,3.42,0,0,0-1-.71,3.19,3.19,0,0,0-1.24-.24,3.1,3.1,0,0,0-1.23.24,3.19,3.19,0,0,0-1.06.71,3.48,3.48,0,0,0-.7,1v0a3.19,3.19,0,0,0-.25,1.24V39.31a.32.32,0,0,1-.32.32H26a.32.32,0,0,1-.32-.32V13.71a3.19,3.19,0,0,0-.25-1.24,3,3,0,0,0-.69-1v0a3.18,3.18,0,0,0-1-.7h0a3.18,3.18,0,0,0-1.23-.25,3.38,3.38,0,0,0-1.24.24,3.3,3.3,0,0,0-1,.71,3.42,3.42,0,0,0-.71,1.05,3.19,3.19,0,0,0-.24,1.24c0,5.14,0,10.61,0,16.06,0,5.11,0,10.24,0,16l-.35,5.87a.34.34,0,0,1-.18.27l-1.15.56a.31.31,0,0,1-.17,0,1.75,1.75,0,0,1-.51-.08,1.84,1.84,0,0,1-.47-.22A9.1,9.1,0,0,1,15,51.35c-.54-.43-1.12-1-1.69-1.49-1.14-1.08-2.29-2.22-2.71-2.65a7.07,7.07,0,0,0-2.5-1.7,3.63,3.63,0,0,0-2.35-.12,2.67,2.67,0,0,0-.7.34,2.84,2.84,0,0,0-.59.5h0a3.53,3.53,0,0,0-.46.68,3.9,3.9,0,0,0-.29.79,4.5,4.5,0,0,0,.33,2.85,8.23,8.23,0,0,0,2.14,2.83l0,0,.17.17c.53.53,1.34,1.4,2.34,2.48,4.47,4.82,12.87,13.87,17.41,15.68,3.45,1.37,9.11,1.76,14.41,1.09,4.43-.57,8.58-1.87,11-4l.95.89,1.66,1.6c-2.89,2.66-7.75,4.32-12.91,5-5.93.81-12.27.36-16.42-1.29-5.13-2-13.09-10.57-18-15.86C5.61,58,4.61,56.89,3.86,56.14l-.07-.07A11.83,11.83,0,0,1,.6,51.67a8,8,0,0,1-.4-4.81,7.07,7.07,0,0,1,.6-1.63,6.84,6.84,0,0,1,1-1.42A6.07,6.07,0,0,1,3.11,42.7,6.58,6.58,0,0,1,4.67,42,7.12,7.12,0,0,1,9,42a10.28,10.28,0,0,1,4.14,2.65l.41.4c.45.45,1.12,1.12,1.84,1.8V45.78a7.87,7.87,0,0,1,0-.84q0-.4.09-.81V13.7a6.87,6.87,0,0,1,4.24-6.33,6.68,6.68,0,0,1,4.62-.22,6.92,6.92,0,0,1,1.34.57V6.86a6.73,6.73,0,0,1,.52-2.62A7,7,0,0,1,27.75,2,6.82,6.82,0,0,1,37.4,2h0a7,7,0,0,1,1.49,2.23,6.92,6.92,0,0,1,.52,2.62v.84a6.86,6.86,0,0,1,1.36-.6,6.76,6.76,0,0,1,2.05-.32h0a6.69,6.69,0,0,1,2.61.53A6.87,6.87,0,0,1,49.18,11a6.68,6.68,0,0,1,.52,2.61v1.19A6.6,6.6,0,0,1,51,14.29Z" />
                    </svg>

                </div>
                <div class="card-body">

                    <h4 class="mb-2">Programas</h4>

                    <?php if ($model->sexo_biologico == 1 && $model->edad > 17) { ?>
                        <?php
                        $parches = $model->getUltimaEncuestaParchesMamarios();
                        if ($parches == null) {
                        ?>
                            <?= '<div class="row">' . Html::a(
                                'E. Parches Mamarios',
                                ['encuesta-parches-mamarios/create'],
                                ['class' => 'ms-2'],
                                $options = ['title' => 'E. Parches Mamarios']
                            ) . '</div>'; ?>
                        <?php } else { ?>
                            <?= '<div class="row">' . Html::a(
                                'Ver ultima Encuesta',
                                ['encuesta-parches-mamarios/view', 'id' => $parches->id],
                                $options = [
                                    'class' => 'linkaModalGeneral ms-2',
                                    'data-title' => "Última Encuesta Parches Mamarios",
                                    'title' => 'Última Encuesta Parches Mamarios',
                                ]
                            ) . '</div>'; ?>

                        <?php } ?>
                    <?php } ?>

                </div>
            </div>

            <div class="card">
                <div class="card-header bg-soft-primary d-flex justify-content-center align-items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision" text-rendering="geometricPrecision" image-rendering="optimizeQuality" fill-rule="evenodd" clip-rule="evenodd" viewBox="0 0 419 511.67" width="125" height="125" fill="currentColor">
                        <path d="M93.01 39.4h46.12C141.84 17.18 159.77 0 181.52 0c21.61 0 39.45 16.95 42.34 38.94l46.76.46c2.61 0 4.7 2.1 4.7 4.71v51.84c0 2.61-2.09 4.7-4.7 4.7H93.06c-2.57 0-4.71-2.09-4.71-4.7V44.11a4.632 4.632 0 0 1 4.66-4.71zm221.96 264.22c57.47 0 104.03 46.58 104.03 104.02 0 57.47-46.59 104.03-104.03 104.03-57.47 0-104.02-46.59-104.02-104.03 0-57.47 46.58-104.02 104.02-104.02zm-24.95 82.62a5.268 5.268 0 0 1 3.53-4.77c-.24-4.12-.75-10.33.38-14.3a17.49 17.49 0 0 1 7.8-9.92c1.33-.81 2.76-1.49 4.24-2.02 2.69-.98 1.36-5.49 4.3-5.55 6.87-.17 18.17 6.11 22.57 10.88 2.81 3.11 4.41 7.12 4.5 11.31l-.28 10.07c1.33.27 2.41 1.2 2.89 2.46 1.47 5.93-12.98 19.93-12.98 21.44.03.51.24 1 .58 1.39 10.02 13.78 37.03 7.63 37.03 35.03l-99.22.01c0-27.42 27.02-21.25 37.04-35.03.49-.72.72-1.12.71-1.44 0-1.33-13.09-14.72-13.09-19.56zM41.73 59.28h23.93v24.37H41.73c-4.77 0-9.12 1.97-12.25 5.1-3.14 3.14-5.1 7.48-5.1 12.24v315.52c0 4.75 1.96 9.1 5.1 12.24 3.15 3.15 7.51 5.12 12.25 5.12h142.61c1.69 8.44 4.17 16.6 7.37 24.38H41.73c-11.45 0-21.9-4.71-29.47-12.28C4.72 438.43 0 427.98 0 416.51V100.99c0-11.48 4.7-21.91 12.25-29.46 7.55-7.55 17.99-12.25 29.48-12.25zm297.54 217.35V100.99c0-4.77-1.96-9.11-5.09-12.26a17.36 17.36 0 0 0-12.26-5.08H298V59.28h23.92c11.44 0 21.86 4.71 29.41 12.25 7.61 7.61 12.32 18.04 12.32 29.46V283.6c-7.79-3.07-15.95-5.42-24.38-6.97zm-206.74-8.06c-7.13 0-12.92-5.79-12.92-12.92s5.79-12.93 12.92-12.93h142.82c7.13 0 12.92 5.8 12.92 12.93s-5.79 12.92-12.92 12.92H132.53zM89.5 241.21c7.98 0 14.44 6.47 14.44 14.44 0 7.98-6.46 14.44-14.44 14.44-7.97 0-14.43-6.46-14.43-14.44 0-7.97 6.46-14.44 14.43-14.44zm0 78.62c7.98 0 14.44 6.47 14.44 14.44 0 7.98-6.46 14.44-14.44 14.44-7.97 0-14.43-6.46-14.43-14.44 0-7.97 6.46-14.44 14.43-14.44zm43.04 27.36c-7.13 0-12.93-5.79-12.93-12.92s5.8-12.93 12.93-12.93h80.96a133.913 133.913 0 0 0-17.26 25.85h-63.7zM89.5 162.61c7.98 0 14.44 6.46 14.44 14.43 0 7.98-6.46 14.44-14.44 14.44-7.97 0-14.43-6.46-14.43-14.44 0-7.97 6.46-14.43 14.43-14.43zm43.03 27.35c-7.13 0-12.92-5.79-12.92-12.92 0-7.14 5.79-12.93 12.92-12.93h142.82c7.13 0 12.92 5.79 12.92 12.93 0 7.13-5.79 12.92-12.92 12.92H132.53zm48.5-169.8c12.3 0 22.26 9.96 22.26 22.27 0 12.29-9.96 22.25-22.26 22.25s-22.26-9.96-22.26-22.25c0-12.31 9.96-22.27 22.26-22.27z" />
                    </svg>
                </div>
                <div class="card-body">
                    <h4 class="mb-2">Más datos</h4>
                    <?= '<div class="row">' . Html::a(
                        'Coberturas',
                        ['personas/viewpuco', 'dni' => $model->documento, 'sexo' =>  $model->sexo_biologico],
                        $options = [
                            'class' => 'linkaModalGeneral ms-2',
                            'title' => 'Coberturas',
                            'data-title' => 'Coberturas'
                        ]
                    ) . '</div>'; ?>


                    <?= '<div class="row">' . Html::a(
                        'Vacunas',
                        ['personas/vacunas', 'dni' => $model->documento, 'sexo' =>  $model->sexo_biologico],
                        $options = [
                            'class' => 'linkaModalGeneral ms-2',
                            'title' => 'Vacunas',
                            'data-title' => 'Vacunas'
                        ]
                    ) . '</div>'; ?>

                </div>

            </div>

            <div class="card">
                <div class="card-header bg-soft-primary d-flex justify-content-center align-items-center">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 122.88 100.54" style="enable-background:new 0 0 122.88 100.54" xml:space="preserve" width="125" height="125" fill="currentColor">
                        <g>
                            <path d="M65.98,54.6H56.9c-0.15,0-0.27,0.06-0.37,0.15c-0.1,0.1-0.15,0.23-0.15,0.37v19.14c0,0.15,0.06,0.27,0.15,0.37 c0.1,0.1,0.23,0.15,0.37,0.15h9.07c0.15,0,0.27-0.06,0.37-0.15c0.1-0.1,0.15-0.23,0.15-0.37V55.12c0-0.15-0.06-0.27-0.15-0.37 C66.25,54.64,66.12,54.6,65.98,54.6L65.98,54.6L65.98,54.6z M6.98,13.97h31.49V4.94c0-1.37,0.56-2.6,1.45-3.49 C40.82,0.56,42.06,0,43.41,0h36.06c1.37,0,2.59,0.56,3.49,1.45c0.89,0.89,1.45,2.14,1.45,3.49v9.03h31.49 c1.93,0,3.67,0.79,4.92,2.06c1.27,1.27,2.06,3.01,2.06,4.92v16.86c-7.89,5.41-16.03,10.02-24.42,13.78 c-8.44,3.78-17.14,6.71-26.14,8.73v-6.74c0-1.54-0.63-2.96-1.64-3.98c-1.01-1.01-2.43-1.64-3.98-1.64H56.17l0,0 c-1.54,0-2.96,0.63-3.98,1.64c-1.01,1.01-1.64,2.43-1.64,3.98v6.59c-8.76-2.01-17.25-4.89-25.48-8.58 C16.45,47.73,8.1,42.96,0,37.36V20.95c0-1.93,0.79-3.67,2.06-4.92C3.32,14.76,5.07,13.97,6.98,13.97L6.98,13.97L6.98,13.97z M122.88,47.81v45.76c0,1.93-0.79,3.67-2.06,4.92c-1.27,1.27-3.01,2.06-4.92,2.06H6.98c-1.93,0-3.67-0.79-4.92-2.06 C0.79,97.22,0,95.48,0,93.57V47.39c6.89,4.42,13.98,8.28,21.27,11.55c9.41,4.22,19.17,7.45,29.29,9.61v7.25 c0,1.54,0.63,2.96,1.64,3.98c1.01,1.01,2.44,1.64,3.98,1.64h10.53c1.54,0,2.96-0.63,3.98-1.64c1.01-1.01,1.64-2.43,1.64-3.98v-7.6 l0.11,0.46c10.31-2.17,20.25-5.43,29.83-9.73C109.33,55.77,116.2,52.05,122.88,47.81L122.88,47.81z M75.71,6.73H47.19 c-0.17,0-0.31,0.06-0.44,0.19c-0.1,0.1-0.19,0.27-0.19,0.44v6.42h29.75V7.36c0-0.17-0.06-0.31-0.19-0.44 c-0.1-0.1-0.27-0.19-0.44-0.19H75.71L75.71,6.73z" />
                        </g>
                    </svg>
                </div>
                <?php if (User::canRoute(['/rrhh-efector/create'])) { ?>
                    <div class="card-body">
                        <h4 class="mb-2">Administración</h4>
                        <div class="row">
                            <?php
                            echo SisseGhostHtml::a(
                                'Editar acceso a BIOENLACE',
                                ['/user/update', 'id' => $model->id_user],
                                ['class' => 'ms-2', 'title' => 'Editar datos de acceso a BIOENLACE']
                            );
                            ?>
                        </div>
                        <div class="row">
                            <?php
                            echo SisseGhostHtml::a(
                                'Administrar RRHH',
                                ['/rrhh-efector/create'],
                                ['class' => 'ms-2', 'title' => 'Administrar persona como recurso humano']
                            );
                            ?>
                        </div>
                    </div>
                <?php } ?>
            </div>
        </div>
    </div>
</div>


<?php
Modal::begin([
    'title' => '<h4 id="modal-title"></h4>',
    'id' => 'modal-general',
    'size' => 'modal-lg',
]);
echo "<div id='modal-content'></div>";
Modal::end();
?>

<?php
$this->registerJs(
    "$(function(){
            
            $(function(){
                $('#modal-general').on('submit', 'form', function(e) {
                    e.preventDefault();
                    var form = $(this);
                    var formData = form.serialize();
                    $.ajax({
                        url: form.attr('action'),
                        type: form.attr('method'),
                        data: formData,
                        success: function (data) {
                            if(typeof(data.success) !== 'undefined') {
                                location.reload();
                               $('#modal-general').modal('hide');                                
                            } else {
                                $('#modal-content').html(data);                            
                            }
                        },
                        error: function () {
                            $('body').append('<div class=\"alert alert-success\" role=\"alert\">'
                                +'<i class=\"fa fa-exclamation fa-1x\"></i> Error inesperado</div>'); 
                            window.setTimeout(function() { $('.alert').alert('close'); }, 6000); 
                            $('#modal-general').modal('hide');
                        }
                    });
                    
                });            
            });
        });                        
    "
);
?>