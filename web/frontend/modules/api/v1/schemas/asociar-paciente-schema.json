{
    "title": "Asociar Paciente",
    "$schema": "http://json-schema.org/draft-07/schema#",

    "definitions": {
        "common": {
            "type": "object",
            "oneOf": [
                { "required": ["id"] },
                { "required": ["texto"] }
            ],
            "properties": {
                "id": { "type": "string" },
                "texto": { "type": "string" }
            }
        },

        "contact": {
            "type": "array",
            "minItems": 1,
            "maxItems": 2,
            "items": { "type": "string" }
        }
    },

    "type": "object",
    "properties": {
        "paciente": {
            "type": "object",
            "properties": {
                "identificador": {
                    "type": "object",
                    "properties": {
                        "mpi": { "type": "string" },
                        "local": { "type": "string" }
                    },
                    "required": ["mpi", "local"]
                },
                "set_ampliado": {
                    "type": "object",
                    "anyOf": [
                        { "required": ["contacto"] },
                        { "required": ["residencia"] }
                    ],
                    "properties": {
                        "contacto": {
                            "type": "object",
                            "anyOf": [
                                { "required": ["telefono"] },
                                { "required": ["email"] }
                            ],
                            "properties": {
                                "telefono": {
                                    "type": "object",
                                    "anyOf": [
                                        { "required": ["fijo"] },
                                        { "required": ["celular"] }
                                    ],
                                    "properties": {
                                        "fijo": { "$ref": "#/definitions/contact" },
                                        "celular": { "$ref": "#/definitions/contact" }
                                    }
                                },
                                "email": { "$ref": "#/definitions/contact" }
                            }
                        },
                        "residencia": {
                            "type": "object",
                            "properties": {
                                "provincia": { "$ref": "#/definitions/common" },
                                "departamento": { "$ref": "#/definitions/common" },
                                "localidad": { "$ref": "#/definitions/common" },
                                "calle": { "type": "string" },
                                "numero": { "type": "string" },
                                "piso": { "type": "integer" },
                                "depto": { "type": "string" },
                                "geoposicion": {
                                    "type": "object",
                                    "properties": {
                                        "latitud": { "type": "number" },
                                        "longitud": { "type": "number" }
                                    },
                                    "required": ["latitud", "longitud"]
                                }
                            },
                            "required": ["provincia", "departamento", "localidad", "calle", "numero"]
                        }
                    }
                }
            },
            "required": ["identificador"]
        }
    },
    "required": ["paciente"]
}